# @package training
_target_: src.training.trainer.GANTrainer

# Training config
max_epochs: 100
gradient_clip_val: 1.0
accumulate_grad_batches: 1

# Validation
val_check_interval: 1.0
limit_val_batches: 1.0

# Mixed precision
precision: 16  # 16, 32, bf16

# Callbacks
callbacks:
  - _target_: pytorch_lightning.callbacks.ModelCheckpoint
    dirpath: "checkpoints"
    filename: "{epoch:02d}-{fid:.2f}"
    monitor: "fid"
    mode: "min"
    save_top_k: 3
    save_last: true
    
  - _target_: pytorch_lightning.callbacks.EarlyStopping
    monitor: "fid"
    patience: 20
    mode: "min"
    
  - _target_: pytorch_lightning.callbacks.LearningRateMonitor
    logging_interval: "epoch"
    
  - _target_: src.training.callbacks.SampleCallback
    sample_frequency: 5
    num_samples: 64

# Logging
logger:
  - _target_: pytorch_lightning.loggers.TensorBoardLogger
    save_dir: "logs"
    name: "gan_experiment"
    
# Profiler
profiler: null  # pytorch, simple, advanced
